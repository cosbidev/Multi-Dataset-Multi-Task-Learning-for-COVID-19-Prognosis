seed: 0
exp_name: resnet_ae_multimodal_mlp

device:
  #cuda_device: cuda:0
  gpu_num_workers: 32

data:
  cv: 10
  fold_dir: ./data/processed/folds/10 # folder where upload the CV splits at patient level
  model_dir: ./models/10/multimodal/multimodal_autoencoder_mlp # folder to save trained model
  report_dir: ./reports/10/multimodal/multimodal_autoencoder_mlp # folder to save results
  classes: # name of classes
    - MILD
    - SEVERE
  batch_size: 16
  modes:
    clinical:
      data_file: ./data/processed/clinical_data.csv # clinical data file
    img:
      loader_name: XRayVision_preprocessing
      img_dir: ../data/AIforCOVID/imgs # path of img directory
      box_file: ./data/processed/box_data.xlsx  # if equal to None do not select the bounding box
      mask_dir:
      img_dim: 224 # resize shape (square)

model:
  model_name: resnet_ae_multimodal_mlp
  modes:
    clinical:
      model_name: fc
      pretrained: ./models/10/clinical/clinical_autoencoder
    img:
      model_name: resnet_ae
      pretrained: ./models/10/img/img_resnet_ae
      h_dim:
  h_dim: 4616
  dropout_rate: 0.25

trainer:
  loss_weights:
    1: 1
    2: 1
    3: 1
  optimizer:
    lr: 0.0001 # initial learning rate
    weight_decay: 0.00001 # weight decay
  scheduler: # allow to change learning rate during training
    mode: min
    patience: 10 # if the validation loss do not improve for x epochs, the scheduler reduces the learning rate (lr*10^-1)
  early_stopping: 100 # if the validation loss do not improve for x epochs stop training
  max_epochs: 100

features:
  feature_dir: ./data/interim/features/10/multimodal/multimodal_autoencoder_mlp # where to save interim features

explainability:
  prototypes:
    gamma: 0.026
    k: 3 # total number of criticism to select
    m: 3 # total number of prototypes to select
    kernel_type: 1  # 1 for local, 0 for global